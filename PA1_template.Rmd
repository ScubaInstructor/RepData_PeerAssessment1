---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
* Load data file
```{r echo=TRUE}
fitdata <- read.csv("RepData_PeerAssessment1/activity.csv")
```

* Process data: steps~date
```{r echo=TRUE}
totalSteps <- aggregate(steps~date, data=fitdata, sum, na.rm=TRUE)
```

## What is mean total number of steps taken per day?

* Histogram of the total number of steps taken each day
```{r echo=TRUE}
hist(totalSteps$steps)
```

* Mean of the total number of steps taken per day
```{r echo=TRUE}
mean(totalSteps$steps, na.rm = TRUE)
```

* Median of the total number of steps taken per day
```{r echo=TRUE}
median(totalSteps$steps, na.rm = TRUE)
```

## What is the average daily activity pattern?

* Plot daily activity pattern of the 5-minute interval and average number of steps taken
```{r echo=TRUE}
stepsInterval<-aggregate(steps~interval,data=fitdata,mean,na.rm=TRUE)
plot(steps~interval,data=stepsInterval,type="l")
```
* 5-minute interval with maximum number of steps on average across all days
```{r echo=TRUE}
stepsInterval[which.max(stepsInterval$steps),]
```

## Imputing missing values

* Number of rows in dataset with missing values
```{r echo=TRUE}
sum(is.na(fitdata))
```

* Strategy:  Use the mean for that 5-minute interval to fill in missing values (utilizing below function) 

```{r echo=TRUE}
meanIntervalSteps<-function(interval){
    stepsInterval[stepsInterval$interval==interval,]$steps
}
```

* Create a copy of the original data and fill NA rows with chosen strategy:

```{r echo=TRUE}
fitdataComplete<-fitdata             
for(i in 1:nrow(fitdataComplete)){
  if(is.na(fitdataComplete[i,]$steps)){
    fitdataComplete[i,]$steps<-meanIntervalSteps(fitdataComplete[i,]$interval)
  }
}
```
* Process complete data: steps~date
```{r echo=TRUE}
totalStepsComplete <- aggregate(steps~date, data=fitdataComplete, sum, na.rm=TRUE)
```

* Mean of the total number of steps taken per day without missing values
```{r echo=TRUE}
mean(totalStepsComplete$steps, na.rm = TRUE)
```

* Median of the total number of steps taken per day
```{r echo=TRUE}
median(totalStepsComplete$steps, na.rm = TRUE)
```

## Are there differences in activity patterns between weekdays and weekends?
