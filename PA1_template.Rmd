---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
* Load data file
```{r echo=TRUE}
fitdata <- read.csv("RepData_PeerAssessment1/activity.csv")
```

* Process data: steps~date
```{r echo=TRUE}
totalSteps <- aggregate(steps~date, data=fitdata, sum, na.rm=TRUE)
```

## What is mean total number of steps taken per day?

* Histogram of the total number of steps taken each day
```{r echo=TRUE}
hist(totalSteps$steps)
```

* Mean of the total number of steps taken per day
```{r echo=TRUE}
mean(totalSteps$steps, na.rm = TRUE)
```

* Median of the total number of steps taken per day
```{r echo=TRUE}
median(totalSteps$steps, na.rm = TRUE)
```

## What is the average daily activity pattern?

* Plot daily activity pattern of the 5-minute interval and average number of steps taken
```{r echo=TRUE}
stepsInterval<-aggregate(steps~interval,data=fitdata,mean,na.rm=TRUE)
plot(steps~interval,data=stepsInterval,type="l")
```
* 5-minute interval with maximum number of steps on average across all days
```{r echo=TRUE}
stepsInterval[which.max(stepsInterval$steps),]
```

## Imputing missing values

* Number of rows in dataset with missing values
```{r echo=TRUE}
sum(is.na(fitdata))
```

* Filing in all of the missing values with the mean for that 5-minute interval. 

```{r echo=TRUE}
interval2steps<-function(interval){
    stepsInterval[stepsInterval$interval==interval,]$steps
}
```



## Are there differences in activity patterns between weekdays and weekends?
